# Vision Document  
## Trusted Environment Bootstrap (RISC-V) — bootstrap  

**Версия:** 0.1  
**Дата:** 2025-10-19  
**Автор:** Даниил Смолин 

---

## 1. Назначение документа
Цель данного документа — описать концепцию, цели, ценность и границы проекта «bootstrap», представляющего собой систему доверенной пошаговой сборки (bootstrap pipeline) для архитектуры RISC-V. Документ служит ориентиром для команды разработки, преподавателей и рецензентов, отражая видение конечного результата и ключевых этапов реализации.

---

## 2. Предпосылки и мотивация

Современные инструментальные цепочки (toolchains) — компиляторы, линкеры, сборщики — часто зависят от уже существующих бинарных файлов, происхождение которых не всегда прозрачно. Это снижает доверие к конечной системе.

В области системной безопасности и открытых архитектур (например, RISC-V) существует потребность в полностью воспроизводимом и проверяемом процессе построения программной среды «из минимальной доверенной основы».

Наш проект преследует образовательную, исследовательскую и инженерную цели:
- глубоко понять процесс создания системы «с нуля»;
- обеспечить строгую воспроизводимость;
- формировать основу доверенной среды исполнения;
- поддержать дальнейшие эксперименты с ранним пользователем (QEMU / железо).

---

## 3. Общая цель продукта

Система «bootstrap» должна обеспечить:
- Воспроизводимую цепочку сборки начальных инструментов (stage0 → stage1 → stage2 → …);  
- Подтвердить воспроизводимость через double compilation / divorce bootstrap (дополнительная сборка образа независимыми путями с сопоставлением артефактов).
- Разработать и запустить минимальное ядро и boot-среду на архитектуре RISC-V.
- Обеспечить запуск как на QEMU virt, так и на реальной платформе Lichee Pi 4A.

Продукт развивается пошагово, где каждая стадия включает:
- определённую входную среду,  
- результат в виде артефакта следующего уровня,  
- критерий готовности.

---

## 4. Заинтересованные стороны и их выгоды

| Роль / Стейкхолдер | Интерес / выгода |
|--------------------|-----------------|
| Студенты-разработчики | Получение глубокого понимания механизмов загрузки, компоновки и trust chain. |
| Преподаватели | Возможность оценить владение студентами системными концепциями и инженерным мышлением. |
| CI-система | Автоматизация проверки воспроизводимости и стабильности сборки. |

---

## 5. Проблемное поле / Потребности

| Проблема | Как решает проект |
|----------|-------------------|
| Недоверие к существующим бинарникам | Построение инструментов поэтапно из минимальной основы. |
| Непрозрачная сборка систем | Логи, детерминированность, контрольные суммы. |
| Тяжело понять внутреннюю кухню RISC-V запуска | Пошаговая сборка и запуск образов на QEMU и железе. |
| Обучение архитектуре на абстракциях | Проект формирует прямую связь «инструкция → бинарь → запуск». |

---

## 6. Цели проекта

- Организовать минимальную доверенную цепочку создания бинарного образа.  
- Обеспечить запуск образа на эмуляторе QEMU.  
- Достичь воспроизводимости артефактов при повторных сборках.  
- Документировать pipeline, memory map, точки входа, ключевые зависимости.  
- Продемонстрировать принципы divorce double compilation, подтвердив доверие через независимую сборку одинаковых артефактов.
- Разработать минимальное ядро (kernel stub) и boot-код.
- Подтвердить возможность запуска на Lichee Pi 4A (не только в QEMU).
- Обеспечить возможность расширения пайплайна до stage2 и далее.  
- Подготовить основу для запуска минимального программного окружения на RISC-V железе.

---

## 7. Ключевые характеристики и функциональность

| Функция | Описание |
|---------|----------|
| Bootstrap pipeline | Цепочка сборки артефактов с фиксированными стадиями. |
| Генерация ELF → BIN | Преобразование входного ELF в бинарный образ с указанной entry-точкой. |
| Запуск через `make qemu` | Автоматически запуск образа с выводом на UART0. |
| Контроль воспроизводимости | Подсчёт SHA256 артефактов и их сравнение. |
| Memory Map визуализация | Документированная карта распределения памяти. |
| Поддержка целевых платформ | QEMU (обяз.), Lichee Pi 4A (опционально). |
| Документация | SRS, Vision, Schedule, архитектурное описание. |

---

## 8. Область и границы проекта (Scope)

Включает:
- Реализацию pipeline до готового запускаемого образа;
- Использование фиксированного компилятора (внешний или stage0);
- Запуск на QEMU virt;
- Контроль хешей артефактов;
- Поддержку документации.

Не включает (в версии 0.1):
- Полноценную ОС;
- Реализацию динамического загрузчика (дополнительные стадии);
- Разработку сети, файловых систем;
- Поддержку всех платформ RISC-V.

---

## 9. Критерии успеха (Success Criteria)

- Образ успешно запускается через `make qemu`;  
- Минимальное ядро (kernel stub) успешно выполняется на Lichee Pi 4A.
- Divorce double compilation показывает совпадение контрольных сумм артефактов.
- Документация (SRS + Vision + Memory Map) завершена;  
- План расширения до следующей стадии определён.

---

## 10. Основные риски

| Риск | Митигирующая мера |
|------|-------------------|
| Несогласованность стадий | Чёткое документирование SRS и memory map |
| Зависимость от нестабильных внешних бинарников | Версионирование и проверка хешей |
| Отсутствие запуска на реальном железе | Приоритет QEMU, железо — в резерве |
| Ошибки в точках входа / линковке | Memory Map и юнит-проверки запуска |

---

## 11. Видение эволюции (Roadmap)

| Версия | Содержание | Статус |
|--------|-----------|--------|
| 0.1 | Stage1 pipeline, QEMU, SRS/Vision, запуск на Lichee Pi 4A | в разработке |
| 0.2 | Stage2, расширенные тесты, документация | планируется |
| 1.0 | Завершённый bootstrap для минимальной системы с ядром и boot| опционально |

---

## 13. Заключение

Проект «bootstrap» нацелен на создание доверенной среды загрузки в архитектуре RISC-V, опираясь на воспроизводимость, прозрачность и образовательный подход. Он служит фундаментом для глубокого понимания систем низкого уровня и может масштабироваться до полноценной bootstrap-цепочки.

